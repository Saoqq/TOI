# 2 - Максимум апостериорной вероятности

![scheme](максимум%20апостериорной%20вероятности.svg)

1) Входные данные:

   - кол-во классов $M$ (они образуют конечное число альтернативных статистических гипотез $\Omega=\{\omega_j, j=\overline{1,M}\}$);
   - априорные вероятности гипотез $p(\omega_i),\; i=\overline{1,M}$;
   - функция правдоподобия $f_x(x|\omega_i)=p(x|\omega_i),\; i=\overline{1,M}$;
   - образ $x$, который необходимо распознать  

2) Данный алгоритм является частным случаем алгоритма мининимума условного риска. В нём влияние ошибочных решений считается одинаковым, а за правильное решение штрах равен нулю:

    $$
    \lambda_{ij} = \left\{\begin{array}{l}0,\;i=j,\\1,\;i\;\neq j;\end{array}\right. i=\overline{1,M}, \; j=\overline{1,M}.
    $$
    В этом случае функция условного риска принимает вид:
    $$
    r(\alpha_i|x)=\sum\limits_{j=1}^M p(\omega_j|x)=1-p(\omega_i|x);\;\;\; j\neq i,\;\; i=\overline{1,M}.
    $$
    Теперь необходимо находить максимальное значение апостериорной вероятности для распознования данного образа $x$.

    Разделяющая функция имеет вид:
    $$
    g_i(x)=p(\omega_i|x); \; i=\overline{1,M}.
    $$
    Либо, с учётом формулы Байеса
    <font size="1">(выражение сокращено на $p(x)$)</font>:
    $$
    g_i(x)=p(\omega_i)p(x|\omega_i); \; i=\overline{1,M}.
    $$

3) Решение для образа $x$ будет приниматься в пользу гипотезы $\omega_i$, если:

    $$
    \omega_i: g_i(x) \geqslant g_j(x), \; j=\overline{1,M}, \; i\neq j;
    $$
    $$
    \omega_i: p(\omega_i|x) \geqslant p(\omega_j|x), \; j=\overline{1,M}, \; i\neq j;
    $$
    $$
    \omega_i: l_{ij}(x) =
    \frac{p(x\vert\omega_i)}{p(x\vert\omega_j)}
    \mathop{\gtrless}_{\omega_j}^{\omega_i}
    \frac{p(\omega_j)}{p(\omega_i)} =
    l_{0ij}; \; \; \;
    j=\overline{1,M}, \; i\neq j;
    $$
    В данном алгоритме при вычислении порога принятия решения уччитываются только априорные вероятности гипотез.
