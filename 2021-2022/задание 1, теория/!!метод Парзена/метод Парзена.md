# Метод Парзена

## ![scheme](метод%20Парзена.svg)

### Математическое описание:



**Шаг 1:** 

Пусть $X^N = \{(x^{(1)},..,x^{(N)}),\; x^{(i)} \in R \}$ независимые и одинаково распределенные наблюдения значений случайной величины $x$.  

**Шаг 2:** 

Изначально рассмотрим возможную оценку функции распределения СВ. Ее естественно представить в следующем виде: 
$$
\widetilde{F}_x(x)=
\left\{\frac{l(X^N)}{N}=
\frac{1}{N}\sum\limits_{t=1}^N u^{(t)}, \;
u^{(t)}=1:x^{(t)}\leq x, \; u^{(t)}=0:x^{(t)}>x \right\},
$$
т.е. как относительное количество наблюдений, значения которых меньше $x$.

**Шаг 3:**  
Величина $\widetilde{F}_x(x)$ является дискретной случайной величиной, которая распределена по биномиальному закону 
$$
Pr(\widetilde{F}_x(x)=\frac{1}{N})=C^l_N[F_x(x)]^l[1-F_x(x)]^{N-l},
$$
где $F_x(x)$ является истинным значением оцениваемой функции распределения.

**Шаг 4:**  
Выражение для $\widetilde{F}_x(x)$ является оценкой максимального правдоподобия функции распределения, при этом для ее математического ожидания и дисперсии выполняется 
$$
M[\widetilde{F}_x(x)]=
\sum\limits_{i=1}^N \frac{l}{N}C^l_N[F_x(x)]^l[1-F_x(x)]^{N-l}=
F_x(x)
$$
$$
D[\widetilde{F}_x(x)]=
\sum\limits_{i=1}^N [\frac{l}{N}-F_x(x)]^2C^l_N[F_x(x)]^l[1-F_x(x)]^{N-l}=
\frac{F_x(x)(1-F_x(x)}{N}
$$
Следовательно, оценка функции распределения является несмещенной, состоятельной и имеет место сходимость в среднеквадратичном.

**Шаг 5:**  
Размер ячейки должен быть функцией от $h=h(N)$, для которой требуется выполнение следующих условий: 
$$
\underset{N \rightarrow \infty}{\lim} h(N)=0,
\underset{N \rightarrow \infty}{\lim} k_N=0,
\underset{N \rightarrow \infty}{\lim} k_N/N=0.
$$
Первое условие обеспечивает сходимость $P/2h$ к величине $p(x)$ при однородном сокращении ячеек.

Второе условие обеспечивает сходимость по вероятности (при $p(x) \neq 0$) эмпирического отношения частот $\widetilde{P}$ к величине $P$.

Третье условие определяет то, что интересующая оценка является состоятельной оценкой плотности распределения, поскольку гарантирует, что в каждую ячейку попадает небольшое относительно $N$ количество элементов обучающей выборки.

**Шаг 6:**  
Для оценки плотности распределения при обобщении метода Парзена на многомерный случай применяется следующая оценка:
$$
\widetilde{p}(x)=
\frac{1}{Nh^n}\sum\limits_{i=1}^N \varphi(\frac{x-x^{(i)}}{h})
=\int\frac{1}{h^n}\varphi(\frac{x-\varepsilon}{h})d\widetilde{F}_x(\varepsilon)$$
Функция $h^{-1}\varphi(u/h)$ называется ядром, или оконной функцией так как имеет прямоугольный вид, при этом ее форма определяет размер ячейки, относительно которой проводится оценка плотности.

**Шаг 7:**  
Для случая двух классов при неизвестных априорных вероятностях решающее правило будет иметь вид:
$$\frac{N_1}{N_1+N_2}\widetilde{p}(x|\omega_1)
\def\arraystretch{0.6}
\begin{array}{c} 
\small w_1\\ 
{>}\\
<\\
\small w_2
\end{array}
\frac{N_2}{N_1+N_2}\widetilde{p}(x|\omega_2)$$

[Лекция 7](../лекции%20с%20мудла/v7.pdf) стр. 2   
<font size="1" color="red">Где-то взято из лекций, где-то из источника, где-то из старых шпор, использовать на свой страх и риск (лучше попытаться понять сам метод, чем свято верить,что автор сей писанины нигде не объебался)</font> 