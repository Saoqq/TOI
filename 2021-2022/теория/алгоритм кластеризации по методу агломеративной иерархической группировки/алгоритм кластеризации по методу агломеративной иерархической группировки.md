# Алгоритм кластеризации по методу агломеративной иерархической группировки

## ![scheme](алгоритм%20кластеризации%20по%20методу%20агломеративной%20иерархической%20группировки.svg)

### мат. описание:
**шаг 1:** пусть имеется:  
- не помеченная, смешанная выборка образов  
$X^N = \{x^{(1)},...,x^{(N)}\}, x^{(*)}\in R^n$
- $M \ -$ число классов
- $d(x^{(i)},x^{(j)}) \ -$ функция расстояния  

**шаг 2:** 
- устанавливаем значение $\widetilde M, \widetilde M=N,N-$ количество образов в выборке образов.
- делаем начальную кластеризацию $Q_N^1, Q_N^1=\{x^1,...,x^N\}, x^{(*)}=x^*$ *тут прикол в том, что на первом этапе каждый образ образует отдельную группу*  

следующие шаги выполняем в цикле  
**шаг 3:**   
*степень Q это номер итерации, индекс Q - кол-во групп на данной итерации*   
Для $Q_{N-K+1}^k$ и $\widetilde{M}=N-k+1$ находим ближайшую пару групп с использова??? $d(x^{(i)},x^{(j)})$, которая имеет $\underset{i,j}{min} \ D(x^{N_i},x^{N_j})$  
**шаг 4:**
- производим слияние найденных групп $x^{N_i+N_j} = x^{N_i}\cup x^{N_j}$
- изымаем из $Q_{N-k+1}^k$ элемент $x^{N_J}$  

**шаг 5:**  
Образовываем новую кластеризацию $Q_{N-k}^k c новыми обозначениями групп и присвоением $\widetilde M=N-k$

**шаг 6:**  
сравниваем значения $\widetilde M$ и $M$ и, если $\widetilde M$=$M$, то цикл завершается, иначе возвращаемся к шагу 3.  
**Замечание:** если в шаге 1 значение числа классов не задается, то в шаге 6 значение $\widetilde M$ сравнивается с $1$.

[Лекция 12](../лекции%20с%20мудла/v12.pdf)